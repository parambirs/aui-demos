{"version":3,"sources":["js/aui/messages.js"],"names":[],"mappings":";;;;;;;;;;;;;AAAA,gBAAY,CAAC;;;;;;;;;;;;;;AAUb,QAAI,wBAAwB,GAAG,GAAG,CAAC;AACnC,QAAI,qBAAqB,GAAG,IAAI,CAAC;AACjC,QAAI,wBAAwB,GAAG,GAAG,CAAC;;AAEnC,QAAI,gBAAgB,GAChB,sFAAsF,GACtF,mBAAmB,GACnB,0BAA0B,GAC1B,MAAM,GACN,6BAA6B,GAC7B,QAAQ,CAAC;;AAEb,aAAS,wBAAwB,CAAC,IAAI,EAAE;;;;;;;;;;;;;;AAcpC,gBAAQ,CAAC,IAAI,CAAC,GAAG,UAAU,OAAO,EAAE,GAAG,EAAE;AACrC,gBAAI,CAAC,GAAG,EAAE;AACN,mBAAG,GAAG,OAAO,CAAC;AACd,uBAAO,GAAG,kBAAkB,CAAC;aAChC;;;AAGD,eAAG,CAAC,SAAS,GAAG,GAAG,CAAC,SAAS,KAAK,IAAI,IAAI,GAAG,CAAC,SAAS,KAAK,KAAK,CAAC;;;AAGlE,eAAG,CAAC,QAAQ,GAAG,GAAG,CAAC,QAAQ,KAAK,IAAI,IAAI,GAAG,CAAC,QAAQ,KAAK,KAAK,CAAC;;AAE/D,gBAAI,QAAQ,GAAG,oBAAoB,CAAC,IAAI,CAAC,QAAQ,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;AAC9D,oCAAwB,CAAC,QAAQ,EAAE,GAAG,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;;;AAGxD,gBAAI,GAAG,CAAC,SAAS,EAAE;AACf,6BAAa,CAAC,QAAQ,CAAC,CAAC;aAC3B;;AAED,gBAAI,GAAG,CAAC,OAAO,EAAE;AACb,2BAAW,CAAC,QAAQ,EAAE,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC;aAClD;;AAED,mBAAO,QAAQ,CAAC;SACnB,CAAC;KACL;;AAED,aAAS,aAAa,CAAC,OAAO,EAAE;AAC5B,2BAAE,OAAO,IAAI,2BAA2B,CAAC,CAAC,IAAI,CAAC,YAAY;AACvD,gBAAI,KAAK,GAAG,mBAAE,IAAI,CAAC,CAAC;AACpB,gBAAI,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;AACrD,gBAAI,KAAK,GAAG,WAAW,CAAC,MAAM,GAAG,CAAC,GAAG,WAAW,CAAC,KAAK,EAAE,GAAG,mBAAE,sEAAsE,CAAC,CAAC;;AAErI,iBAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;AAC5B,iBAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;;AAEpB,iDAAqC,CAAC,KAAK,CAAC,CAAC;SAChD,CAAC,CAAC;KACN;;AAED,aAAS,WAAW,CAAC,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE;AAC3C,aAAK,GAAG,AAAC,OAAO,KAAK,KAAK,WAAW,GAAI,KAAK,GAAG,qBAAqB,CAAC;AACvE,gBAAQ,GAAG,AAAC,OAAO,QAAQ,KAAK,WAAW,GAAI,QAAQ,GAAG,wBAAwB,CAAC;;AAEnF,2BAAE,OAAO,IAAI,yBAAyB,CAAC,CAAC,IAAI,CAAC,YAAY;AACrD,gBAAI,KAAK,GAAG,mBAAE,IAAI,CAAC,CAAC;;;AAGpB,gBAAI,QAAQ,GAAG,KAAK,CAAC;AACrB,gBAAI,OAAO,GAAG,KAAK,CAAC;;;AAGpB,qBAAS,OAAO,GAAE;;;;;;;;AAQd,qBAAK,CAAC,IAAI,CAAC,IAAI,EAAC,KAAK,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,YAAY;AAC9D,yBAAK,CAAC,YAAY,EAAE,CAAC;iBACxB,CAAC,CAAC;aACN;AACD,qBAAS,YAAY,GAAE;;;;;;AAMnB,qBAAK,CAAC,IAAI,CAAC,IAAI,EAAC,KAAK,CAAC,CAAC,MAAM,CAAC,wBAAwB,EAAE,CAAC,CAAC,CAAC;aAC9D;AACD,qBAAS,kBAAkB,GAAE;AACzB,uBAAO,CAAC,QAAQ,IAAI,CAAC,OAAO,CAAC;aAChC;;;AAGD,iBAAK,CACA,OAAO,CAAC,YAAY;AACjB,wBAAQ,GAAG,IAAI,CAAC;AAChB,4BAAY,EAAE,CAAC;aAClB,CAAC,CACD,QAAQ,CAAC,YAAY;AAClB,wBAAQ,GAAG,KAAK,CAAC;AACjB,oBAAI,kBAAkB,EAAE,EAAE;AACtB,2BAAO,EAAE,CAAC;iBACb;aACJ,CAAC,CACD,KAAK,CACN,YAAY;;AACR,uBAAO,GAAG,IAAI,CAAC;AACf,4BAAY,EAAE,CAAC;aAClB,EACD,YAAY;;AACR,uBAAO,GAAG,KAAK,CAAC;AAChB,oBAAI,kBAAkB,EAAE,EAAE;AACtB,2BAAO,EAAE,CAAC;iBACb;aACJ,CACJ,CAAC;;;AAGF,mBAAO,EAAE,CAAC;SACb,CAAC,CAAC;KACN;;;;;;;;;;;;;;AAcD,QAAI,QAAQ,GAAG;AACX,aAAK,EAAE,iBAAY;AACf,yBAAa,EAAE,CAAC;AAChB,uBAAW,EAAE,CAAC;SACjB;AACD,qBAAa,EAAE,aAAa;AAC5B,mBAAW,EAAE,WAAW;AACxB,gBAAQ,EAAE,gBAAgB;AAC1B,qBAAa,EAAE,wBAAwB;KAC1C,CAAC;;AAEF,aAAS,qCAAqC,CAAC,QAAQ,EAAE;AACrD,gBAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,sBAAsB,EAAE,UAAU,CAAC,EAAE;AACtD,+BAAE,CAAC,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,YAAY,EAAE,CAAC;SACtD,CAAC,CAAC,EAAE,CAAC,SAAS,EAAE,sBAAsB,EAAE,UAAU,CAAC,EAAE;AAClD,gBAAI,AAAC,CAAC,CAAC,KAAK,KAAK,qBAAQ,KAAK,IAAM,CAAC,CAAC,KAAK,KAAK,qBAAQ,KAAK,AAAC,EAAE;AAC5D,mCAAE,CAAC,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,YAAY,EAAE,CAAC;AACnD,iBAAC,CAAC,cAAc,EAAE,CAAC;aACtB;SACJ,CAAC,CAAC;KACN;;AAED,aAAS,wBAAwB,CAAC,QAAQ,EAAE,WAAW,EAAE,OAAO,EAAE;AAC9D,YAAI,WAAW,KAAK,SAAS,EAAE;AAC3B,oBAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;SAC/B,MAAM;AACH,oBAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;SAC9B;KACJ;;AAED,aAAS,oBAAoB,CAAE,cAAc,EAAE,OAAO,EAAE,IAAI,EAAE;;AAE1D,YAAI,QAAQ,GAAG,mBAAE,2BAAS,cAAc,CAAC,CAAC,IAAI,CAAC;AAC3C,gBAAI,EAAE,IAAI;AACV,qBAAS,EAAE,OAAO,CAAC,SAAS,GAAG,WAAW,GAAG,EAAE;AAC/C,oBAAQ,EAAE,OAAO,CAAC,QAAQ,GAAG,UAAU,GAAG,EAAE;AAC5C,mBAAO,EAAE,OAAO,CAAC,OAAO,GAAG,SAAS,GAAG,EAAE;AACzC,iBAAK,EAAE,OAAO,CAAC,KAAK,IAAI,EAAE;AAC1B,uBAAW,EAAE,OAAO,CAAC,IAAI,IAAI,EAAE;SAClC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;;;AAGf,YAAI,OAAO,CAAC,EAAE,EAAE;AACZ,gBAAI,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE;;AAEjC,6BAAO,IAAI,CAAC,+EAA+E,CAAC,CAAC;aAChG,MAAM;AACH,wBAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,EAAE,CAAC,CAAC;aACnC;SACJ;;AAED,eAAO,QAAQ,CAAC;KACnB;;AAED,kBAAE,EAAE,CAAC,YAAY,GAAG,YAAY;AAC5B,YAAI,QAAQ,GAAG,mBAAE,IAAI,CAAC,CAAC;AACvB,YAAI,QAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,EAAE;AACpE,oBAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACpB,oBAAQ,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC;AAClD,+BAAE,QAAQ,CAAC,CAAC,OAAO,CAAC,mBAAmB,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;SACpD;KACJ,CAAC;;AAEF,4BAAwB,CAAC,SAAS,CAAC,CAAC;AACpC,4BAAwB,CAAC,OAAO,CAAC,CAAC;AAClC,4BAAwB,CAAC,SAAS,CAAC,CAAC;AACpC,4BAAwB,CAAC,MAAM,CAAC,CAAC;AACjC,4BAAwB,CAAC,SAAS,CAAC,CAAC;AACpC,4BAAwB,CAAC,MAAM,CAAC,CAAC;;AAEjC,2BAAM,aAAa,EAAE;AACjB,eAAO,EAAE,iBAAU,OAAO,EAAE;AACxB,gBAAI,IAAI,GAAG,OAAO,CAAC,SAAS,CAAC;AAC7B,gBAAI,IAAI,GAAG,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC;;AAElD,mBAAO,CAAC,SAAS,GAAG,EAAE,CAAC;AACvB,oBAAQ,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE;AACpB,oBAAI,EAAE,IAAI;AACV,yBAAS,EAAE,OAAO,CAAC,YAAY,CAAC,WAAW,CAAC;AAC5C,qBAAK,EAAE,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC;AACpC,wBAAQ,EAAE,OAAO,CAAC,YAAY,CAAC,UAAU,CAAC;AAC1C,uBAAO,EAAE,OAAO,CAAC,YAAY,CAAC,SAAS,CAAC;AACxC,qBAAK,EAAE,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC;aACvC,CAAC,CAAC;SACN;KACJ,CAAC,CAAC;;AAEH,uBAAE,YAAY;AACV,gBAAQ,CAAC,KAAK,EAAE,CAAC;KACpB,CAAC,CAAC;;AAEH,yBAAU,IAAI,CAAC,QAAQ,EAAE,eAAe,EAAE;AACtC,iBAAS,EAAE,uHAAuH;KACrI,CAAC,CAAC;;AAEH,yBAAU,IAAI,CAAC,QAAQ,EAAE,eAAe,EAAE;AACtC,iBAAS,EAAE,sIAAsI;KACpJ,CAAC,CAAC;;AAEH,yBAAU,IAAI,CAAC,QAAQ,EAAE,aAAa,EAAE;AACpC,iBAAS,EAAE,qHAAqH;KACnI,CAAC,CAAC;;;;;AAKH,+BAAU,UAAU,EAAE,QAAQ,CAAC,CAAC;;qBAEjB,QAAQ","file":"js/aui/messages.js","sourcesContent":["'use strict';\n\nimport $ from './jquery';\nimport * as deprecate from './internal/deprecation';\nimport * as logger from './internal/log';\nimport globalize from './internal/globalize';\nimport keyCode from './key-code';\nimport skate from './internal/skate';\nimport template from './template';\n\nvar DEFAULT_FADEOUT_DURATION = 500;\nvar DEFAULT_FADEOUT_DELAY = 5000;\nvar FADEOUT_RESTORE_DURATION = 100;\n\nvar MESSAGE_TEMPLATE =\n    '<div class=\"aui-message aui-message-{type} {type} {closeable} {shadowed} {fadeout}\">' +\n    '<p class=\"title\">' +\n    '<strong>{title}</strong>' +\n    '</p>' +\n    '{body}<!-- .aui-message -->' +\n    '</div>';\n\nfunction createMessageConstructor(type) {\n    /**\n     *\n     * @param context\n     * @param {Object} obj - message configuration\n     * @param {boolean} [obj.id] - ID to add to the message\n     * @param {boolean} obj.body - Content of the message\n     * @param {boolean} [obj.closeable]\n     * @param {boolean} [obj.shadowed]\n     * @param {boolean} [obj.fadeout]\n     * @param {boolean} [obj.duration]\n     * @param {boolean} [obj.delay]\n     * @returns {*|HTMLElement}\n     */\n    messages[type] = function (context, obj) {\n        if (!obj) {\n            obj = context;\n            context = '#aui-message-bar';\n        }\n\n        // Set up our template options\n        obj.closeable = obj.closeable !== null && obj.closeable !== false;\n\n        // shadowed no longer does anything but left in so it doesn't break\n        obj.shadowed = obj.shadowed !== null && obj.shadowed !== false;\n\n        var $message = renderMessageElement(this.template, obj, type);\n        insertMessageIntoContext($message, obj.insert, context);\n\n        // Attach the optional extra behaviours\n        if (obj.closeable) {\n            makeCloseable($message);\n        }\n\n        if (obj.fadeout) {\n            makeFadeout($message, obj.delay, obj.duration);\n        }\n\n        return $message;\n    };\n}\n\nfunction makeCloseable(message) {\n    $(message || 'div.aui-message.closeable').each(function () {\n        var $this = $(this);\n        var $closeIcons = $this.find('.aui-icon.icon-close');\n        var $icon = $closeIcons.length > 0 ? $closeIcons.first() : $('<span class=\"aui-icon icon-close\" role=\"button\" tabindex=\"0\"></span>');\n\n        $this.addClass('closeable');\n        $this.append($icon);\n\n        initCloseMessageBoxOnClickAndKeypress($this);\n    });\n}\n\nfunction makeFadeout(message, delay, duration) {\n    delay = (typeof delay !== 'undefined') ? delay : DEFAULT_FADEOUT_DELAY;\n    duration = (typeof duration !== 'undefined') ? duration : DEFAULT_FADEOUT_DURATION;\n\n    $(message || 'div.aui-message.fadeout').each(function () {\n        var $this = $(this);\n\n        //Store the component state to avoid collisions between animations\n        var hasFocus = false;\n        var isHover = false;\n\n        //Small functions to keep the code easier to read and avoid code duplication\n        function fadeOut(){\n            //Algorithm:\n            //1. Stop all running animations (first arg), including any fade animation and delay\n            //   Do not jump to the end of the animation (second arg). This prevents the message to abruptly\n            //   jump to opacity:0 or opacity:1\n            //2. Wait <delay> ms before starting the fadeout\n            //3. Start the fadeout with a duration of <duration> ms\n            //4. Close the message at the end of the animation\n            $this.stop(true,false).delay(delay).fadeOut(duration, function () {\n                $this.closeMessage();\n            });\n        }\n        function resetFadeOut(){\n            //Algorithm:\n            //1. Stop all running animations (first arg), including any fade animation and delay\n            //   Do not jump to the end of the animation (second arg). This prevents the message to abruptly\n            //   jump to opacity:0 or opacity:1\n            //2. Fast animation to opacity:1\n            $this.stop(true,false).fadeTo(FADEOUT_RESTORE_DURATION, 1);\n        }\n        function shouldStartFadeOut(){\n            return !hasFocus && !isHover;\n        }\n\n        //Attach handlers for user interactions (focus and hover)\n        $this\n            .focusin(function () {\n                hasFocus = true;\n                resetFadeOut();\n            })\n            .focusout(function () {\n                hasFocus = false;\n                if (shouldStartFadeOut()) {\n                    fadeOut();\n                }\n            })\n            .hover(\n            function () {  //should be called .hoverin(), but jQuery does not implement that method\n                isHover = true;\n                resetFadeOut();\n            },\n            function () { //should be called .hoverout(), but jQuery does not implement that method\n                isHover = false;\n                if (shouldStartFadeOut()) {\n                    fadeOut();\n                }\n            }\n        );\n\n        //Initial animation\n        fadeOut();\n    });\n}\n\n/**\n * Utility methods to display different message types to the user.\n * Usage:\n * <pre>\n * messages.info(\"#container\", {\n     *   title: \"Info\",\n     *   body: \"You can choose to have messages without Close functionality.\",\n     *   closeable: false,\n     *   shadowed: false\n     * });\n * </pre>\n */\nvar messages = {\n    setup: function () {\n        makeCloseable();\n        makeFadeout();\n    },\n    makeCloseable: makeCloseable,\n    makeFadeout: makeFadeout,\n    template: MESSAGE_TEMPLATE,\n    createMessage: createMessageConstructor\n};\n\nfunction initCloseMessageBoxOnClickAndKeypress($message) {\n    $message.on('click', '.aui-icon.icon-close', function (e) {\n        $(e.target).closest('.aui-message').closeMessage();\n    }).on('keydown', '.aui-icon.icon-close', function (e) {\n        if ((e.which === keyCode.ENTER) || (e.which === keyCode.SPACE)) {\n            $(e.target).closest('.aui-message').closeMessage();\n            e.preventDefault(); // this is especially important when handling the space bar, as we don't want to page down\n        }\n    });\n}\n\nfunction insertMessageIntoContext($message, insertWhere, context) {\n    if (insertWhere === 'prepend') {\n        $message.prependTo(context);\n    } else {\n        $message.appendTo(context);\n    }\n}\n\nfunction renderMessageElement (templateString, options, type) {\n    // Append the message using template\n    var $message = $(template(templateString).fill({\n        type: type,\n        closeable: options.closeable ? 'closeable' : '',\n        shadowed: options.shadowed ? 'shadowed' : '',\n        fadeout: options.fadeout ? 'fadeout' : '',\n        title: options.title || '',\n        'body:html': options.body || ''\n    }).toString());\n\n    // Add ID if supplied\n    if (options.id) {\n        if (/[#\\'\\\"\\.\\s]/g.test(options.id)) {\n            // reject IDs that don't comply with style guide (ie. they'll break stuff)\n            logger.warn('Messages error: ID rejected, must not include spaces, hashes, dots or quotes.');\n        } else {\n            $message.attr('id', options.id);\n        }\n    }\n\n    return $message;\n}\n\n$.fn.closeMessage = function () {\n    var $message = $(this);\n    if ($message.hasClass('aui-message') && $message.hasClass('closeable')) {\n        $message.stop(true); //Stop any running animation\n        $message.trigger('messageClose', [this]).remove();  //messageClose event Deprecated as of 5.3\n        $(document).trigger('aui-message-close', [this]);  //must trigger on document since the element has been removed\n    }\n};\n\ncreateMessageConstructor('generic');\ncreateMessageConstructor('error');\ncreateMessageConstructor('warning');\ncreateMessageConstructor('info');\ncreateMessageConstructor('success');\ncreateMessageConstructor('hint');\n\nskate('aui-message', {\n    created: function (element) {\n        var body = element.innerHTML;\n        var type = element.getAttribute('type') || 'info';\n\n        element.innerHTML = '';\n        messages[type](element, {\n            body: body,\n            closeable: element.getAttribute('closeable'),\n            delay: element.getAttribute('delay'),\n            duration: element.getAttribute('duration'),\n            fadeout: element.getAttribute('fadeout'),\n            title: element.getAttribute('title')\n        });\n    }\n});\n\n$(function () {\n    messages.setup();\n});\n\ndeprecate.prop(messages, 'makeCloseable', {\n    extraInfo: 'Use the \"closeable\" option in the constructor instead. Docs: https://docs.atlassian.com/aui/latest/docs/messages.html'\n});\n\ndeprecate.prop(messages, 'createMessage', {\n    extraInfo: 'Use the provided convenience methods instead e.g. messages.generic(). Docs: https://docs.atlassian.com/aui/latest/docs/messages.html'\n});\n\ndeprecate.prop(messages, 'makeFadeout', {\n    extraInfo: 'Use the \"fadeout\" option in the constructor instead. Docs: https://docs.atlassian.com/aui/latest/docs/messages.html'\n});\n\n// Exporting\n// ---------\n\nglobalize('messages', messages);\n\nexport default messages;\n"],"sourceRoot":"/source/"}