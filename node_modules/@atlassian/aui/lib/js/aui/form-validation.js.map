{"version":3,"sources":["js/aui/form-validation.js"],"names":[],"mappings":"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","file":"js/aui/form-validation.js","sourcesContent":["'use strict';\n\nimport $ from './jquery';\nimport './form-notification';\nimport './form-validation/basic-validators';\nimport amdify from './internal/amdify';\nimport globalize from './internal/globalize';\nimport skate from './internal/skate';\nimport validatorRegister from './form-validation/validator-register';\n\n//Attributes\nvar ATTRIBUTE_VALIDATION_OPTION_PREFIX = 'aui-validation-';\nvar ATTRIBUTE_NOTIFICATION_PREFIX = 'data-aui-notification-';\n\nvar ATTRIBUTE_FIELD_STATE = 'aui-validation-state';\nvar INVALID = 'invalid';\nvar VALID = 'valid';\nvar VALIDATING = 'validating';\nvar UNVALIDATED = 'unvalidated';\n\nvar ATTRIBUTE_VALIDATION_FIELD_COMPONENT = 'data-aui-validation-field';\n\n//Classes\nvar CLASS_VALIDATION_INITIALISED = '_aui-form-validation-initialised';\n\n//Events\nvar EVENT_FIELD_STATE_CHANGED = '_aui-internal-field-state-changed';\n\nfunction isFieldInitialised($field) {\n    return $field.hasClass(CLASS_VALIDATION_INITIALISED);\n}\n\nfunction initValidation($field) {\n    if (!isFieldInitialised($field)) {\n        initialiseDisplayField($field);\n        prepareFieldMarkup($field);\n        bindFieldEvents($field);\n        changeFieldState($field, UNVALIDATED);\n    }\n}\n\nfunction initialiseDisplayField($field) {\n    getDisplayField($field).attr('data-aui-notification-field', '');\n}\n\nfunction prepareFieldMarkup($field){\n    $field.addClass(CLASS_VALIDATION_INITIALISED);\n}\n\nfunction bindFieldEvents($field) {\n    bindStopTypingEvent($field);\n    bindValidationEvent($field);\n}\n\nfunction bindStopTypingEvent($field){\n    var keyUpTimer;\n\n    var triggerStopTypingEvent = function () {\n        $field.trigger('aui-stop-typing');\n    };\n\n    $field.on('keyup', function () {\n        clearTimeout(keyUpTimer);\n        keyUpTimer = setTimeout(triggerStopTypingEvent, 1500);\n    });\n}\n\nfunction bindValidationEvent($field) {\n    var validateWhen = getValidationOption($field, 'when');\n    var watchedFieldID = getValidationOption($field, 'watchfield');\n\n    var elementsToWatch = watchedFieldID ? $field.add('#' + watchedFieldID) : $field;\n\n    elementsToWatch.on(validateWhen, function startValidation () {\n        validationTriggeredHandler($field);\n    });\n}\n\nfunction validationTriggeredHandler($field) {\n    var noValidate = getValidationOption($field, 'novalidate');\n\n    if (noValidate) {\n        changeFieldState($field, VALID);\n        return;\n    }\n\n    return startValidating($field);\n}\n\nfunction getValidationOption($field, option) {\n    var defaults = {\n        'when': 'change'\n    };\n    var optionValue = $field.attr('data-' + ATTRIBUTE_VALIDATION_OPTION_PREFIX + option);\n    if (!optionValue) {\n        optionValue = defaults[option];\n    }\n\n    return optionValue;\n}\n\nfunction startValidating($field) {\n    clearFieldMessages($field);\n\n    var validatorsToRun = getActivatedValidators($field);\n\n    changeFieldState($field, VALIDATING);\n\n    var deferreds = runValidatorsAndGetDeferred($field, validatorsToRun);\n    var fieldValidators = $.when.apply($, deferreds);\n    fieldValidators.done(function () {\n        changeFieldState($field, VALID);\n    });\n\n    return fieldValidators;\n}\n\nfunction clearFieldMessages($field) {\n    setFieldNotification(getDisplayField($field), 'none');\n}\n\nfunction getValidators() {\n    return validatorRegister.validators();\n}\n\nfunction getActivatedValidators($field) {\n    var callList = [];\n    getValidators().forEach(function (validator, index) {\n        var validatorTrigger = validator.validatorTrigger;\n        var runThisValidator = $field.is(validatorTrigger);\n        if (runThisValidator) {\n            callList.push(index);\n        }\n    });\n\n    return callList;\n}\n\nfunction runValidatorsAndGetDeferred($field, validatorsToRun) {\n    var allDeferreds = [];\n\n    validatorsToRun.forEach(function (validatorIndex) {\n        var validatorFunction = getValidators()[validatorIndex].validatorFunction;\n        var deferred = new $.Deferred();\n        var validatorContext = createValidatorContext($field, deferred);\n        validatorFunction(validatorContext);\n\n        allDeferreds.push(deferred);\n    });\n\n    return allDeferreds;\n}\n\nfunction createValidatorContext($field, validatorDeferred) {\n    var context = {\n        validate: function () {\n            validatorDeferred.resolve();\n        },\n        invalidate: function (message) {\n            changeFieldState($field, INVALID, message);\n            validatorDeferred.reject();\n        },\n        args: createArgumentAccessorFunction($field),\n        el: $field[0],\n        $el: $field\n    };\n\n    AJS.deprecate.prop(context, '$el', {\n        sinceVersion: '5.9.0',\n        removeInVersion: '5.10.0',\n        alternativeName: 'el',\n        extraInfo: 'See https://ecosystem.atlassian.net/browse/AUI-3263.'\n    });\n\n    return context;\n}\n\nfunction createArgumentAccessorFunction($field) {\n    return function (arg) {\n        return $field.attr('data-' + ATTRIBUTE_VALIDATION_OPTION_PREFIX + arg) || $field.attr(arg);\n    };\n}\n\nfunction changeFieldState($field, state, message) {\n    $field.attr('data-' + ATTRIBUTE_FIELD_STATE, state);\n\n    if (state === UNVALIDATED) {\n        return;\n    }\n\n    $field.trigger($.Event(EVENT_FIELD_STATE_CHANGED));\n\n    var $displayField = getDisplayField($field);\n\n    var stateToNotificationTypeMap = {};\n    stateToNotificationTypeMap[VALIDATING] = 'wait';\n    stateToNotificationTypeMap[INVALID] = 'error';\n    stateToNotificationTypeMap[VALID] = 'success';\n\n    var notificationType = stateToNotificationTypeMap[state];\n\n    if (state === VALIDATING) {\n        showSpinnerIfSlow($field);\n    } else {\n        setFieldNotification($displayField, notificationType, message);\n    }\n\n}\n\nfunction showSpinnerIfSlow($field) {\n    setTimeout(function () {\n        var stillValidating = getFieldState($field) === VALIDATING;\n        if (stillValidating) {\n            setFieldNotification($field, 'wait');\n        }\n    }, 500);\n}\n\nfunction setFieldNotification($field, type, message) {\n    var spinnerWasVisible = isSpinnerVisible($field);\n    removeIconOnlyNotifications($field);\n    var skipShowingSuccessNotification = (type === 'success') && !spinnerWasVisible;\n    if (skipShowingSuccessNotification) {\n        return;\n    }\n\n    if (type === 'none') {\n        removeFieldNotification($field, 'error');\n    } else {\n        var previousMessage = $field.attr(ATTRIBUTE_NOTIFICATION_PREFIX + type) || '[]';\n        var newMessage = message ? combineJSONMessages(message, previousMessage) : '';\n        $field.attr(ATTRIBUTE_NOTIFICATION_PREFIX + type, newMessage);\n    }\n}\n\nfunction removeIconOnlyNotifications($field) {\n    removeFieldNotification($field, 'wait');\n    removeFieldNotification($field, 'success');\n}\n\nfunction removeFieldNotification($field, type) {\n    $field.removeAttr(ATTRIBUTE_NOTIFICATION_PREFIX + type);\n}\n\nfunction isSpinnerVisible($field) {\n    return $field.is('[' + ATTRIBUTE_NOTIFICATION_PREFIX + 'wait]');\n}\n\nfunction combineJSONMessages(newString, previousString) {\n    var previousStackedMessageList = JSON.parse(previousString);\n    var newStackedMessageList = previousStackedMessageList.concat([newString]);\n    var newStackedMessage = JSON.stringify(newStackedMessageList);\n    return newStackedMessage;\n}\n\nfunction getDisplayField($field) {\n    var displayFieldID = getValidationOption($field, 'displayfield');\n    var notifyOnSelf = (displayFieldID === undefined);\n    return notifyOnSelf ? $field : $('#' + displayFieldID);\n}\n\nfunction getFieldState($field) {\n    return $field.attr('data-' + ATTRIBUTE_FIELD_STATE);\n}\n\n/**\n * Trigger validation on a field manually\n * @param $field the field that validation should be triggered for\n */\nfunction validateField($field) {\n    $field = $($field);\n    validationTriggeredHandler($field);\n}\n\n/**\n * Form scrolling and submission prevent based on validation state\n * -If the form is unvalidated, validate all fields\n * -If the form is invalid, go to the first invalid element\n * -If the form is validating, wait for them to validate and then try submitting again\n * -If the form is valid, allow form submission\n */\n$(document).on('submit', function (e) {\n    var form = e.target;\n    var $form = $(form);\n\n    var formState = getFormStateName($form);\n    if (formState === UNVALIDATED) {\n        delaySubmitUntilStateChange($form, e);\n        validateUnvalidatedFields($form);\n    } else if (formState === VALIDATING) {\n        delaySubmitUntilStateChange($form, e);\n    } else if (formState === INVALID) {\n        e.preventDefault();\n        selectFirstInvalid($form);\n    } else if (formState === VALID) {\n        var validSubmitEvent = $.Event('aui-valid-submit');\n        $form.trigger(validSubmitEvent);\n        var preventNormalSubmit = validSubmitEvent.isDefaultPrevented();\n        if (preventNormalSubmit) {\n            e.preventDefault(); //users can bind to aui-valid-submit for ajax forms\n        }\n    }\n});\n\nfunction delaySubmitUntilStateChange($form, event) {\n    event.preventDefault();\n    $form.one(EVENT_FIELD_STATE_CHANGED, function () {\n        $form.trigger('submit');\n    });\n}\n\nfunction getFormStateName($form) {\n    var $fieldCollection = $form.find('.' + CLASS_VALIDATION_INITIALISED);\n    var fieldStates = getFieldCollectionStateNames($fieldCollection);\n    var wholeFormState = mergeStates(fieldStates);\n    return wholeFormState;\n}\n\nfunction getFieldCollectionStateNames($fields) {\n    var states = $.map($fields, function (field) {\n        return getFieldState($(field));\n    });\n    return states;\n}\n\nfunction mergeStates(stateNames) {\n    var containsInvalidState = stateNames.indexOf(INVALID) !== -1;\n    var containsUnvalidatedState = stateNames.indexOf(UNVALIDATED) !== -1;\n    var containsValidatingState = stateNames.indexOf(VALIDATING) !== -1;\n\n    if (containsInvalidState) {\n        return INVALID;\n    } else if (containsUnvalidatedState) {\n        return UNVALIDATED;\n    } else if (containsValidatingState) {\n        return VALIDATING;\n    } else {\n        return VALID;\n    }\n}\n\nfunction validateUnvalidatedFields($form) {\n    var $unvalidatedElements = getFieldsInFormWithState($form, UNVALIDATED);\n    $unvalidatedElements.each(function (index, el) {\n        validator.validate($(el));\n    });\n}\n\nfunction selectFirstInvalid($form) {\n    var $firstInvalidField = getFieldsInFormWithState($form, INVALID).first();\n    $firstInvalidField.focus();\n}\n\nfunction getFieldsInFormWithState($form, state) {\n    var selector = '[data-' + ATTRIBUTE_FIELD_STATE + '=' + state + ']';\n    return $form.find(selector);\n}\n\n\nvar validator = {\n    register: validatorRegister.register,\n    validate: validateField\n};\n\nskate(ATTRIBUTE_VALIDATION_FIELD_COMPONENT, {\n    attached: function (field) {\n        if (field.form) {\n            field.form.setAttribute('novalidate', 'novalidate');\n        }\n        var $field = $(field);\n        initValidation($field);\n        skate.init(field); //needed to kick off form notification skate initialisation\n    },\n    type: skate.type.ATTRIBUTE\n});\n\namdify('aui/form-validation', validator);\nglobalize('formValidation', validator);\nexport default validator;\n"],"sourceRoot":"/source/"}