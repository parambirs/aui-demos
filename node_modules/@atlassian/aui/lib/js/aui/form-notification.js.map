{"version":3,"sources":["js/aui/form-notification.js"],"names":[],"mappings":"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","file":"js/aui/form-notification.js","sourcesContent":["'use strict';\n\nimport $ from './jquery';\nimport '../../js-vendor/jquery/jquery.tipsy';\nimport * as logger from './internal/log';\nimport amdify from './internal/amdify';\nimport keyCode from './key-code';\nimport skate from './internal/skate';\n\nvar NOTIFICATION_NAMESPACE = 'aui-form-notification';\n\nvar CLASS_NOTIFICATION_INITIALISED = '_aui-form-notification-initialised';\nvar CLASS_NOTIFICATION_ICON = 'aui-icon-notification';\nvar CLASS_TOOLTIP = NOTIFICATION_NAMESPACE + '-tooltip';\nvar CLASS_TOOLTIP_ERROR = CLASS_TOOLTIP + '-error';\nvar CLASS_TOOLTIP_INFO = CLASS_TOOLTIP + '-info';\n\nvar ATTRIBUTE_NOTIFICATION_PREFIX = 'data-aui-notification-';\nvar ATTRIBUTE_NOTIFICATION_WAIT = ATTRIBUTE_NOTIFICATION_PREFIX + 'wait';\nvar ATTRIBUTE_NOTIFICATION_INFO = ATTRIBUTE_NOTIFICATION_PREFIX + 'info';\nvar ATTRIBUTE_NOTIFICATION_ERROR = ATTRIBUTE_NOTIFICATION_PREFIX + 'error';\nvar ATTRIBUTE_NOTIFICATION_SUCCESS = ATTRIBUTE_NOTIFICATION_PREFIX + 'success';\nvar ATTRIBUTE_TOOLTIP_POSITION = NOTIFICATION_NAMESPACE + '-position';\n\nvar NOTIFICATION_PRIORITY = [\n    ATTRIBUTE_NOTIFICATION_ERROR,\n    ATTRIBUTE_NOTIFICATION_SUCCESS,\n    ATTRIBUTE_NOTIFICATION_WAIT,\n    ATTRIBUTE_NOTIFICATION_INFO\n];\n\nvar notificationFields = [];\n\n/* --- Tipsy configuration --- */\nvar TIPSY_OPACITY = 1;\nvar TIPSY_OFFSET_INSIDE_FIELD = 9; //offset in px from the icon to the start of the tipsy\nvar TIPSY_OFFSET_OUTSIDE_FIELD = 3;\n\nfunction initialiseNotification($field) {\n    if (!isFieldInitialised($field)) {\n        prepareFieldMarkup($field);\n        initialiseTooltip($field);\n        bindFieldEvents($field);\n        synchroniseNotificationDisplay($field);\n    }\n\n    notificationFields.push($field);\n}\n\nfunction isFieldInitialised($field) {\n    return $field.hasClass(CLASS_NOTIFICATION_INITIALISED);\n}\n\nfunction constructFieldIcon(){\n    return $('<span class=\"aui-icon aui-icon-small ' + CLASS_NOTIFICATION_ICON + '\"/>');\n}\n\nfunction prepareFieldMarkup($field) {\n    $field.addClass(CLASS_NOTIFICATION_INITIALISED);\n    appendIconToField($field);\n}\n\nfunction appendIconToField($field) {\n    var $icon = constructFieldIcon();\n    $field.after($icon);\n}\n\nfunction initialiseTooltip($field) {\n    getTooltipAnchor($field).tipsy({\n        gravity: getTipsyGravity($field),\n        title: function () {\n            return getNotificationMessage($field);\n        },\n        trigger: 'manual',\n        offset: canContainIcon($field) ? TIPSY_OFFSET_INSIDE_FIELD : TIPSY_OFFSET_OUTSIDE_FIELD,\n        opacity: TIPSY_OPACITY,\n        className: function () {\n            return 'aui-form-notification-tooltip ' + getNotificationClass($field);\n        },\n        html: true\n    });\n}\n\n// A list of HTML5 input types that don't typically get augmented by the browser, so are safe to put icons inside of.\nvar unadornedInputFields = ['text', 'url', 'email', 'tel', 'password'];\n\nfunction canContainIcon($field) {\n    return unadornedInputFields.indexOf($field.attr('type')) !== -1;\n}\n\nfunction getNotificationMessage($field) {\n    var notificationType = getFieldNotificationType($field);\n    var message = notificationType ? $field.attr(notificationType) : '';\n    return formatMessage(message);\n}\n\nfunction formatMessage(message) {\n    if (message === '') {\n        return message;\n    }\n\n    var messageArray = jsonToArray(message);\n\n    if (messageArray.length === 1) {\n        return messageArray[0];\n    } else {\n        return '<ul><li>' + messageArray.join('</li><li>') + '</li></ul>';\n    }\n}\n\nfunction jsonToArray(jsonOrString) {\n    var jsonArray;\n    try {\n        jsonArray = JSON.parse(jsonOrString);\n    }\n    catch (exception) {\n        jsonArray = [jsonOrString];\n    }\n    return jsonArray;\n}\n\nfunction getNotificationClass($field) {\n    var notificationType = getFieldNotificationType($field);\n\n    if (notificationType === ATTRIBUTE_NOTIFICATION_ERROR) {\n        return CLASS_TOOLTIP_ERROR;\n    } else if (notificationType === ATTRIBUTE_NOTIFICATION_INFO) {\n        return CLASS_TOOLTIP_INFO;\n    }\n}\n\nfunction getFieldNotificationType($field) {\n    var fieldNotificationType;\n    NOTIFICATION_PRIORITY.some(function (prioritisedNotification) {\n        if ($field.is('[' + prioritisedNotification + ']')) {\n            fieldNotificationType = prioritisedNotification;\n            return true;\n        }\n    });\n\n    return fieldNotificationType;\n}\n\nfunction bindFieldEvents($field) {\n    if (focusTogglesTooltip($field)) {\n        bindFieldTabEvents($field);\n    }\n}\n\nfunction focusTogglesTooltip($field) {\n    return $field.is(':aui-focusable');\n}\n\nfunction fieldHasTooltip($field) {\n    return getNotificationMessage($field) !== '';\n}\n\nfunction showTooltip($field) {\n    getTooltipAnchor($field).tipsy('show');\n    if (focusTogglesTooltip($field)) {\n        bindTooltipTabEvents($field);\n    }\n}\n\nfunction hideTooltip($field) {\n    getTooltipAnchor($field).tipsy('hide');\n}\n\nfunction bindFocusTooltipInteractions() {\n    document.addEventListener('focus', function (e) {\n        notificationFields.forEach(function (field) {\n            var $field = $(field);\n            var $tooltip = getTooltip($field);\n\n            if (!focusTogglesTooltip($field)) {\n                return;\n            }\n\n            var isFocusInTooltip = $tooltip && $.contains($tooltip[0], e.target);\n            var isFocusTargetField = $field.is(e.target);\n            var isFocusTargetChildOfField = isFocusEventTargetInElement(e, $field);\n\n            if (isFocusTargetField || isFocusTargetChildOfField) {\n                showTooltip($field);\n            } else if ($tooltip && !isFocusInTooltip) {\n                hideTooltip($field);\n            }\n        });\n    }, true);\n}\n\nbindFocusTooltipInteractions();\n\nfunction isFocusEventTargetInElement(event, $element) {\n    return $(event.target).closest($element).length > 0;\n}\n\nfunction bindFieldTabEvents($field) {\n    $field.on('keydown', function (e) {\n        if (isNormalTab(e) && fieldHasTooltip($field)) {\n            var $firstTooltipLink = getFirstTooltipLink($field);\n            if ($firstTooltipLink.length) {\n                $firstTooltipLink.focus();\n                e.preventDefault();\n            }\n        }\n    });\n}\n\nfunction isNormalTab(e) {\n    return e.keyCode === keyCode.TAB && !e.shiftKey && !e.altKey;\n}\n\nfunction isShiftTab(e) {\n    return e.keyCode === keyCode.TAB && e.shiftKey;\n}\n\nfunction getFirstTooltipLink($field) {\n    return getTooltip($field).find(':aui-tabbable').first();\n}\n\nfunction getLastTooltipLink($field) {\n    return getTooltip($field).find(':aui-tabbable').last();\n}\n\nfunction getTooltip($field) {\n    var $anchor = getTooltipAnchor($field);\n    if ($anchor.data('tipsy')) {\n        return $anchor.data('tipsy').$tip;\n    }\n}\n\nfunction bindTooltipTabEvents($field) {\n    var $tooltip = getTooltip($field);\n    $tooltip.on('keydown', function (e) {\n        var leavingTooltipForwards = elementIsActive(getLastTooltipLink($field));\n        var leavingTooltipBackwards = elementIsActive(getFirstTooltipLink($field));\n\n        if (isNormalTab(e) && leavingTooltipForwards) {\n            if (leavingTooltipForwards) {\n                $field.focus();\n            }\n        }\n        if (isShiftTab(e) && leavingTooltipBackwards) {\n            if (leavingTooltipBackwards) {\n                $field.focus();\n                e.preventDefault();\n            }\n        }\n    });\n}\n\nfunction getTipsyGravity($field) {\n    var position = $field.data(ATTRIBUTE_TOOLTIP_POSITION) || 'side';\n    var gravityMap = {\n        side: 'w',\n        top: 'se',\n        bottom: 'ne'\n    };\n    var gravity = gravityMap[position];\n    if (!gravity) {\n        gravity = 'w';\n        logger.warn('Invalid notification position: \"' + position + '\". Valid options are \"side\", \"bottom, \"top\"');\n    }\n    return gravity;\n}\n\nfunction getTooltipAnchor($field) {\n    return getFieldIcon($field);\n}\n\nfunction getFieldIcon($field) {\n    return $field.next('.' + CLASS_NOTIFICATION_ICON);\n}\n\nfunction elementIsActive($el) {\n    var el = ($el instanceof $) ? $el[0]: $el;\n    return el && el === document.activeElement;\n}\n\nfunction synchroniseNotificationDisplay(field) {\n    var $field = $(field);\n\n    if (!isFieldInitialised($field)) {\n        return;\n    }\n\n    var notificationType = getFieldNotificationType($field);\n\n    var showSpinner = notificationType === ATTRIBUTE_NOTIFICATION_WAIT;\n    setFieldSpinner($field, showSpinner);\n    var noNotificationOnField = !notificationType;\n    if (noNotificationOnField) {\n        hideTooltip($field);\n        return;\n    }\n\n    var message = getNotificationMessage($field);\n\n    var fieldContainsActiveElement = $.contains($field[0], document.activeElement);\n    var tooltipShouldBeVisible = (fieldContainsActiveElement || elementIsActive($field) || !focusTogglesTooltip($field));\n    if (tooltipShouldBeVisible && message) {\n        showTooltip($field);\n    } else {\n        hideTooltip($field);\n    }\n}\n\nfunction setFieldSpinner($field, isSpinnerVisible) {\n    if (isSpinnerVisible) {\n        getFieldIcon($field).addClass('aui-icon-wait');\n    } else {\n        getFieldIcon($field).removeClass('aui-icon-wait');\n    }\n}\n\ndocument.addEventListener('mousedown', function (e) {\n    var isTargetLink = $(e.target).is('a');\n    if (isTargetLink) {\n        return;\n    }\n\n    var isTargetTooltip = $(e.target).closest('.aui-form-notification-tooltip').length > 0;\n    if (isTargetTooltip) {\n        return;\n    }\n\n    var $allNotificationFields = $('[data-aui-notification-field]');\n    $allNotificationFields.each(function () {\n        var $notificationField = $(this);\n\n        var targetIsThisField = $notificationField.is(e.target);\n        var isFocusTargetChildOfField = isFocusEventTargetInElement(e, $notificationField);\n\n        if (!targetIsThisField && !isFocusTargetChildOfField) {\n            hideTooltip($notificationField);\n        }\n        if (focusTogglesTooltip($notificationField)) {\n            hideTooltip($notificationField);\n        }\n    });\n});\n\nskate('data-aui-notification-field', {\n    attached: function (element) {\n        initialiseNotification($(element));\n    },\n    attributes: (function () {\n        var attrs = {};\n        NOTIFICATION_PRIORITY.forEach(function (type) {\n            attrs[type] = synchroniseNotificationDisplay;\n        });\n        return attrs;\n    }()),\n    type: skate.type.ATTRIBUTE\n});\n\namdify('aui/form-notification');\n"],"sourceRoot":"/source/"}